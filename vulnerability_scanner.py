import scanner

# target_url = "http://10.0.2.16/mutillidae"

target_url = "http://10.0.2.16/dvwa"
links_to_ignore = ["http://10.0.2.16/dvwa/logout.php"]

data_dict = {"username":"admin", "password":"password", "Login":"submit"} 

vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
vuln_scanner.session.post("http://10.0.2.16/dvwa/login.php", data=data_dict)

vuln_scanner.crawl()
vuln_scanner.run_scanner()

# forms = vuln_scanner.extract_forms("http://10.0.2.16/dvwa/vulnerabilities/xss_r/")
# print(forms)
# response = vuln_scanner.submit_form(forms[0], "testtest", "http://10.0.2.16/dvwa/vulnerabilities/xss_r/")
# print(response.content)

# response = vuln_scanner.test_xss_in_form(forms[0], "http://10.0.2.16/dvwa/vulnerabilities/xss_r/")
# print(response)

# http://10.0.2.16/dvwa/vulnerabilities/fi/?page=include.php = False
# response = vuln_scanner.test_xss_in_link("http://10.0.2.16/dvwa/vulnerabilities/xss_r/?name=test")
# print(response)






